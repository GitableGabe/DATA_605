---
title: 'DATA 605: Computational Mathematics Homework 3'
author: "Gabriel Campos"
date: "Last edited `r format(Sys.time(), '%B %d, %Y')`"
output:
  pdf_document:
    latex_engine: xelatex
  geometry: left=0.5cm,right=0.5cm,top=1cm,bottom=2cm
  html_document:
    df_print: paged
  html_notebook: default
urlcolor: blue
---

## Library

```{r, warning=FALSE, message=FALSE}
# Data load
data(cars)
# libraries
library(dplyr)
library(ggplot2)
library(ggthemes)
library(lmtest)
```


# Problem 1

**Transportation Safety**

**Task**

Using the cars dataset in R, perform the following steps:

## 1 

**Data Visualization**

### i

Create a scatter plot of stopping distance (dist) as a function of speed (speed).

```{r}
ggplot(cars, aes(x = speed, y = dist)) +
  geom_point() +
  labs(
    title = "Stopping Distance as a Function of Speed",
    x = "Speed (mph)",
    y = "Stopping Distance (ft)"
  ) +
  theme_minimal()
```

### ii

Add a regression line to the plot to visually assess the relationship.

```{r, message=FALSE}
ggplot(cars, aes(x = speed, y = dist)) +
  geom_point(color = "darkorange", size = 3) + 
  geom_smooth(method = "lm", color = "steelblue", se = FALSE) +
  labs(
    title = "Stopping Distance as a Function of Speed",
    x = "Speed (mph)",
    y = "Stopping Distance (ft)"
  ) +
  theme_minimal()
```


## 2 

**Build a Linear Model**

### i

Construct a simple linear regression model where stopping distance (dist) is the dependent variable and speed (speed) is the independent variable.

```{r}
cars_model <- lm(dist~speed, data = cars)
```


### ii

Summarize the model to evaluate its coefficients, R-squared value, and p-value.

```{r}
summary(cars_model)
```

- **Intercept & Speed** of -17.5791 just indicates the stopping distance at 0 mph. The value is not important only because logically a vehicle not in motion (0mph) does not require stopping distance. The value of $3.9324$ indicates for every 1 mph $3.9324 \ ft$ is needed to stop. Therefore a minimum speed of $\approx 4.48 \ mph$ is needed before any distance is actually needed to stop.
- **R-Squared** value of $0.6511$ indicates $\approx 65\%$ of variance is captured by this relationship, so its a moderate indicator, and there may be several more and potentially stronger factor that can be used to predict the distance needed to stop.
- **P-Value** of $1.49e^{12}$ indicates that the relationship is statistically significant.

### 3

**Model Quality Evaluation**

### i

Calculate and interpret the R-squared value to assess the proportion of variance in stopping distance explained by speed.

- **R-Squared** as indicated above this means $\approx 65\%$ of the variance is captured, making this a moderate factor to stopping distance.
- **R-Squared Adjusted** Frankly, there is only 2 attributes to this table, so adjusting according to the number of predictors of the model makes little difference, therefore the variance of $0.6438$ or $\approx 64\%$  is relatively the same to the original, and the remaining factors would include attributes not collected in our dataset.

### ii

Perform a residual analysis to check the assumptions of the linear regression model, including linearity, homoscedasticity, independence, and normality of residuals.

**In order to do this without repeating the steps for Section 4 we leverage the various functions in R through the package [lmtest](https://cran.r-project.org/web/packages/lmtest/index.html)**


```{r}
cars_resid_values <- resid(cars_model)
cars_fitted_values <- fitted(cars_model)
```

```{r}
summary(cars_resid_values)
```

```{r}
lmtest::bptest(cars_model)
```

```{r}
cor(cars_fitted_values, cars$dist)
```


```{r}
dwtest(cars_model)
```

```{r, warning=FALSE}
ks.test(cars_resid_values, "pnorm", mean=mean(cars_resid_values, sd = sd(cars_resid_values)))
```




- We have an mean of 0 which is ideal
- A correlation of  $0.8068949$ suggests strong linearity since it is close to 1.
- the $p-value>0.05$ through the *Breusch-Pagan test* ( **bptest()** ) which it is at $0.7297$ indicates homoscedasticity. 
- the $p-value$ through the *Durbin-Watson test* ( **dwtest()** ) of $0.09522$ indicated residuals are independent or has no significant autocorrelation in residuals.
- the $p-value$ through the *Kolmogorav-Smirnov test* ( **ks.test()** ) of $3.283 \times 10^-11$/ indicates its not normally distributed.


## 4

**Residual Analysis**

### i

Plot the residuals versus fitted values to check for any patterns.

```{r}
plot(cars_fitted_values, cars_resid_values, 
     xlab = "Fitted Values", 
     ylab = "Residuals", 
     main = "Cars: Residuals vs Fitted Values",
     pch = 20, 
     col = "navyblue")
abline(h = 0, col = "darkred", lty = 2)
```



### ii

Create a Q-Q plot of the residuals to assess normality.

```{r}
qqnorm(cars_resid_values, 
       main = "Q-Q Plot of Residuals", 
       pch = 20, 
       col = "darkblue")
qqline(cars_resid_values, col = "darkorange", lty = 2)
```


### iii

Perform a Shapiro-Wilk test for normality of residuals.

```{r}
cars_shapiro_test <- shapiro.test(cars_resid_values)
cars_shapiro_test
```


### iv

Plot a histogram of residuals to further check for normality.

```{r}
hist(cars_resid_values, 
     breaks = 10, # Adjust the number of bins as needed
     col = "lightgrey", 
     main = "Histogram of Residuals", 
     xlab = "Residuals",
     ylab = "Frequency",
     border = "black")
```


### Conclusion

Based on the model summary and residual analysis, determine whether the linear model is appropriate for this data. Discuss any potential violations of model assumptions and suggest improvements if necessary.

The model for this data set is reasonably appropriate, as it demonstrates moderate explanatory power $(R^2 \approx 0.65)$. While the Q-Q plot and histogram suggest residuals indicate near-normal residuals, the Shapiro-Wilk test $(p=0.02152)$ suggests mild non-normality. Additionally, the residuals vs fitted plot reveals 3 outliers that may impact the models validity. To improve the model, we can consider removing or adjusting for these outliers or testing a non-linear regression model to capture potential curvature in the data.

# Problem 2

**Health Policy Analyst**

As a health policy analyst for an international organization, you are tasked with analyzing data from the World Health Organization (WHO) to inform global health policies. The dataset provided (who.csv) contains crucial health indicators for various countries from the year 2008. The variables include:

- Country: Name of the country
- LifeExp: Average life expectancy for the country in years
- InfantSurvival: Proportion of those surviving to one year or more
- Under5Survival: Proportion of those surviving to five years or more
- TBFree: Proportion of the population without TB
- PropMD: Proportion of the population who are MDs
- PropRN: Proportion of the population who are RNs
- PersExp: Mean personal expenditures on healthcare in US dollars at average exchange rate
- GovtExp: Mean government expenditures per capita on healthcare, US dollars at average exchange rate
- TotExp: Sum of personal and government expenditures

Your analysis will directly influence recommendations for improving global life expectancy and the allocation of healthcare resources.

```{r, warning=FALSE}
who_df <- read.csv("who.csv", fileEncoding = "UTF-8")%>%
              select(-LifeExp.1,-X)
```

## Question 1 

**Initial Assessment of Healthcare Expenditures and Life Expectancy**

**Task**

Create a scatterplot of LifeExp vs. TotExp to visualize the relationship between healthcare expenditures and life expectancy across countries. Then, run a simple linear regression with LifeExp as the dependent variable and TotExp as the independent variable (without transforming the variables).

- Provide and interpret the F-statistic, R-squared value, standard error, and p-values.
- Discuss whether the assumptions of simple linear regression (linearity, independence, homoscedasticity, and normality of residuals) are met in this analysis.


```{r}
str(who_df)
```

```{r}
summary(who_df)
```

**Create a scatterplot of LifeExp vs. TotExp**

```{r, warning=FALSE}
ggplot(who_df, aes(x = TotExp, y = LifeExp)) +
  geom_point(alpha = 0.7) +
  labs(
    title = "Scatterplot of Life Expectancy vs Total Expenditures",
    x = "Total Healthcare Expenditures (US Dollars)",
    y = "Life Expectancy (Years)"
  ) +
  theme_minimal()
```

```{r}
who_model <- lm(LifeExp ~ TotExp, data = who_df)
```

```{r}
summary(who_model)
```

```{r}
#Residuals vs Fitted
plot(who_model, which = 1)
```

```{r}
# Q-Q plot
plot(who_model, which = 2)
```

```{r}
# Histogram of residuals
hist(residuals(who_model), breaks = 20, main = "Histogram of Residuals", xlab = "Residuals")
```

**Discussion**

### i.

Consider the implications of your findings for health policy. Are higher healthcare expenditures generally associated with longer life expectancy? 

The data shows a moderate positive relationship between healthcare expenditures and life expectancy.

- $F-statistic$ of $14.96$ and $p-value \approx 0.0004$ indicates statistical significance, suggesting the variables have a meaningful relationship with life expectancy. However, the models explains limited variability in life expectancy.
- Standard Error $(SE)$ of $10.15$ suggests a relatively good fit,providing reasonable precision of the estimating regression coefficient such as slope or intercept.
- A positive coefficient $9.641 \times 10^{-5}$ implies as healthcare expenditure increases, life expectancy improves. However, the magnitude suggests a small incremental effect.
- The residuals deviates significantly from normality, as shown by the Q-Q plot and supported by the Histogram of Residuals.
- There are no evident signs of homoscedasticity. The points do not show randomness or form a funnel or fan like shape.
- There is a clear pattern with the residuals, which do not appear random, with a visible curvature. This indicates a non-linear relationship between the variables, and makes it innappropriate to assume independence of residuals.

### ii.

What do the assumptions of the regression model suggest about the reliability of this relationship?
$R^2 = 0.2772$ suggests the relationship is no particularly strong, implying that while healthcare expenditures explain some variation in life expectancy, the model does not capture all the influencing factors.

## Question 2

**Transforming Variables for a Better Fit**

**Task**

Recognizing potential non-linear relationships, transform the variables as follows

- Raise life expectancy to the 4.6 power (LifeExp^4.6).
- Raise total expenditures to the 0.06 power (TotExp^0.06), which is nearly a logarithmic transformation.

Create a new scatterplot with the transformed variables and re-run the simple linear regression model.

- Provide and interpret the F-statistic, R-squared value, standard error, and p-values for the transformed model.
- Compare this model to the original model (from Question 1). Which model provides a better fit, and why?

```{r}
who_df$LifeExp_t <- who_df$LifeExp^4.6
who_df$TotExp_t <- who_df$TotExp^0.6
```

```{r, warning=FALSE}
ggplot(who_df, aes(x = TotExp_t, y = LifeExp_t)) +
  geom_point(alpha = 0.7) +
  labs(
    title = "Scatterplot of Life Expectancy^4.6 vs Total Expenditures^0.6",
    x = "Total Healthcare Expenditures (US Dollars)",
    y = "Life Expectancy (Years)"
  ) +
  theme_clean()
```

```{r}
who_model_t <- lm(LifeExp_t ~ TotExp_t, data = who_df)
summary(who_model_t)
```

```{r}
#Residuals vs Fitted
plot(who_model_t, which = 1)
```


```{r}
# Q-Q plot
plot(who_model_t, which = 2)
```

```{r}
# Histogram of residuals
hist(residuals(who_model_t), breaks = 20, main = "Histogram of Residuals", xlab = "Residuals")
```

- $F-statistic$ of $56.09$ and $p-value = 4.61 \times 10^{9}$ indicates the transformed model is statistical significance and captures greater proportion of variability.
- Standard Error $(SE)$ of $116,900,000$ suggests a worse fit with the precision of the estimated regression coefficient. However, this is more likely a result of the greater magnitude of the transformed variables rather than an actual decline in performance.
- Positive coefficient $295,518$ implies as healthcare expenditure increases so does life expectancy still, reflecting a stronger relationship compared to the original model.
- The residuals appear more normalized, as shown with the Histogram of Residuals and Q-Q plot. Deviations are still present, however they are less severe than the original model.
- No homoscedasticity appears with the transformation.
- Residual patterns still do not support independence between the variables.

**Discussion**

### i 

How do the transformations impact the interpretation of the relationship between healthcare spending and life expectancy? 

$R^2 = 0.5898$ suggests the relationship is strong, particularly when compare to the predecessor.

### ii

Why might the transformed model be more appropriate for policy recommendations?

The stronger relationship is highlighted after the transformation, which better accounts for the complex, non-linear relationship between healthcare expenditures and life expectancy. This approach reduces risk in model specification and captures the diminishing return on healthcare spending, that has less of an impact after a certain threshold.

## Question 3

**Forecasting Life Expectancy Based on Transformed Expenditures**

**Task**

Using the results from the transformed model in Question 2, forecast the life expectancy for countries with the following transformed total expenditures $(TotalExp^{0.06})$:

- When $TotExp^{0.06}=1.5$
- When $TotExp^{0.06}=2.5$

```{r}
who_df$TotExp_t15 <- who_df$TotExp^1.5
who_df$TotExp_t25 <- who_df$TotExp^2.5
```

```{r, warning=FALSE}
ggplot(who_df, aes(x = TotExp_t15, y = LifeExp_t)) +
  geom_point(alpha = 0.7) +
  labs(
    title = "Scatterplot of Life Expectancy^1.5 vs Total Expenditures^0.6",
    x = "Total Healthcare Expenditures (US Dollars)",
    y = "Life Expectancy (Years)"
  )
```

```{r}
who_model_t15 <- lm(LifeExp_t ~ TotExp_t15, data = who_df)
summary(who_model_t15)
```

```{r}
#Residuals vs Fitted
plot(who_model_t15, which = 1)
```

```{r}
# Q-Q plot
plot(who_model_t15, which = 2)
```

```{r}
# Histogram of residuals
hist(residuals(who_model_t15), breaks = 20, main = "Histogram of Residuals", xlab = "Residuals")
```


```{r, warning=FALSE}
ggplot(who_df, aes(x = TotExp_t25, y = LifeExp_t)) +
  geom_point(alpha = 0.7) +
  labs(
    title = "Scatterplot of Life Expectancy^2.5 vs Total Expenditures^0.6",
    x = "Total Healthcare Expenditures (US Dollars)",
    y = "Life Expectancy (Years)"
  ) +
  theme_calc()
```

```{r}
who_model_t25 <- lm(LifeExp_t ~ TotExp_t25, data = who_df)
summary(who_model_t25)
```

```{r}
#Residuals vs Fitted
plot(who_model_t25, which = 1)
```

```{r}
# Q-Q plot
plot(who_model_t25, which = 2)
```

```{r}
# Histogram of residuals
hist(residuals(who_model_t25), breaks = 20, main = "Histogram of Residuals", xlab = "Residuals")
```

**Discussion:**

Discuss the implications of these forecasts for countries with different levels of healthcare spending. What do these predictions suggest about the potential impact of increasing healthcare expenditures on life expectancy?

The results reveal that transformed healthcare expenditures positively correlate with life expectancy, emphasizing the role of healthcare spending in improving population health, but its not as simple as "spend more, live forever". In countries with lower levels of spending, increased investment in healthcare could yield substantial gains in life expectancy,but returns will diminish as expenditures grow larger. The residual standard error and adjusted $R^2$ values, indicate substantial unexplained variability and suggesting life expectancy is influenced by factors beyond spending. A multifaceted approach that targets spending and addresses other determinents would yield greater benefits to the analysis.

## Question 4

**Interaction Effects in Multiple Regression**

**Task**

Build a multiple regression model to investigate the combined effect of the proportion of MDs and total healthcare expenditures on life expectancy. Specifically, use the model:

$LifeExp=b_0+b_1 \cdot PropMD + b_2 \cdot TotExp + b_3 \cdot (PropMD \times TotExp)$

- interpret the F-statistic, R-squared value, standard error, and p-values.
- Evaluate the interaction term (PropMD * TotExp). 

What does this interaction tell us about the relationship between the number of MDs, healthcare spending, and life expectancy?

**First I'll create an interaction model and test for significance**

```{r}
who_model_tMD_int <- lm(LifeExp ~ PropMD * TotExp, data = who_df)
summary(who_model_tMD_int)
```

```{r}
#Residuals vs Fitted
plot(who_model_tMD_int, which = 1)
```

```{r}
# Q-Q plot
plot(who_model_tMD_int, which = 2)
```

```{r}
# Histogram of residuals
hist(residuals(who_model_tMD_int), breaks = 20, main = "Histogram of Residuals", xlab = "Residuals")
```


**Considering the results I will create an additive model to interpret how they jointly affect LifeExp**


```{r}
who_model_tMD_add <- lm(LifeExp ~ PropMD + TotExp, data = who_df)
summary(who_model_tMD_add)
```


```{r}
#Residuals vs Fitted
plot(who_model_tMD_add, which = 1)
```

```{r}
# Q-Q plot
plot(who_model_tMD_add, which = 2)
```

```{r}
# Histogram of residuals
hist(residuals(who_model_tMD_add), breaks = 20, main = "Histogram of Residuals", xlab = "Residuals")
```

**Discussion**

### i

How does the presence of more MDs amplify or diminish the effect of healthcare expenditures on life expectancy? 

- Positive coefficient $4.396 \times 10^3$ from the interaction model suggests that on average, an increase of proportion of MDS leads to higher life expectancy.
- Positive coefficient $2.050 \times 10^{-4}$ implies increased healthcare expenditures is associated with higher life expectancy, assuming PropMD stays constant.
- Negative coefficient $-4.935 \times 10^{-2}$ suggests PropMD and LifeExp depends on TotExp, and vice-versa, with the positive effect of PropMD and LifeExp diminishing as TotExp increase, vice-versa.
- This generally implies diminishing return on increase of Expenditures and MDs.
- The p-value for $PropMD$ and $TotExp$ which is $0.02969$ suggests a meaningful relationship.
- For the additive model the coefficients PropMD($3.533 \times 10^{3}$) and - TotExp($5.579 \times 10^{-5}$) are still positive but smaller than the interaction model.
- The $R^2 = 0.452$ from the interaction model reducing to $R^2 = 0.3519$ in the additive, suggests less visibility with the additive.

### ii 

What policy recommendations can be drawn from this analysis?

Since the results basically describe diminishing returns on excessive increase of MDs or Expenditures, a balance between the two is ideal. For low-spending countries, increasing MDs can offset decreased life expectancy, while in high spending countries, increasing MDs may not produce substantial improvement in life expectancy.

## Question 5

**Forecasting Life Expectancy with Interaction Terms**

**Task**

Using the multiple regression model from Question 4, forecast the life expectancy for a country where:

The proportion of MDs is 0.03 (PropMD = 0.03).
The total healthcare expenditure is 14 (TotExp = 14).

In order to forecast I will use the $predict()$ function which takes in two parameters: a fitted model object and a dataframe. For the prediction, we are specifically  interested in the interaction model. The use of the interaction model is because it captures the complexity of this nuance relationship, including the diminishing returns, while maintaining a relatively high level of statistical significance.

```{r}
who_para <- data.frame(PropMD = 0.03, TotExp = 14)
pred_life_exp <- predict(who_model_tMD_int, newdata = who_para)
pred_life_exp
```


**Discussion**

### i

Does this forecast seem realistic?

No it does not.

### ii

Why or why not? 

Life span of the oldest person in history was only 122 in 1875, and it is very uncommon for individuals with the most optimal healthcare available, to live many years past 100.

### iii

Consider both the potential strengths and limitations of using this model for forecasting in real-world policy settings.

The data is suited for a curve model, as noted before. The data not actually being linear, potential outliers and the impact of the interaction between the variables magnitude effectively created this unrealistic prediction.

# Problem 3

## Question 1

**Inventory Cost**

**Scenario**

A retail company is planning its inventory strategy for the upcoming year. They expect to sell 110 units of a high-demand product. The storage cost is \$3.75 per unit per year, and there is a fixed ordering cost of \$8.25 per order. The company wants to minimize its total inventory cost.

**Task**

Using calculus, determine the optimal lot size (the number of units to order each time) and the number of orders the company should place per year to minimize total inventory costs. Assume that the total cost function is given by:

$C(Q)=\frac{D}{Q} \times S + \frac{Q}{2} \times H$

Where:

- $D$ is total demand (110 units).
- $Q$ is the order quantity.
- $S$ is the fixed ordering cost per order ($8.25).
- $H$ is the holding cost per unit per year ($3.75).

**Solution**

- $Ordering \ Cost = \frac{D}{Q} \times S$
- $Holding \ Cost = \frac{Q}{2} \times H$

*As per the equation and description*

We can substitute and calculate for:

$C(Q)=\frac{D}{Q} \times S + \frac{Q}{2} \times H$ to get $\rightarrow C(Q)=\frac{110}{Q} \times 8.25 + \frac{Q}{2} \times 3.75$

and simplify to $\rightarrow C(Q)=\frac{907.5}{Q} + \frac{3.75Q}{2}$

the derivative for both is going to essentially be the power rule $f'(x) = n \cdot x^{n-1}$

$\frac{d}{dQ}(\frac{907.5}{Q})\rightarrow\frac{d}{dQ}(907.5 \times Q^{-1})$

which becomes $-907.5 \times Q^{-2} = -\frac{907.5}{Q^2}$

and derivative for $\frac{d}{dQ}(\frac{3.75Q}{2}) \rightarrow \frac{d}{dQ} \frac{3.75}{2} \times Q^1$

becomes just $\frac{3.75}{2}$

so our equation becomes $\frac{dC(Q)}{dQ} = -\frac{907.5}{Q^2} + \frac{3.75}{2}$

To find our critical point we can set to $0$

$-\frac{907.5}{Q^2} + \frac{3.75}{2}=0 \rightarrow \frac{907.5}{Q^2} = \frac{3.75}{2} \rightarrow 907.5 = \frac{3.75}{2} \times Q^2 \rightarrow 1815 = 3.75 \times Q^2 \rightarrow Q^2 =484$

finally when we find the square root we get $Q = \sqrt{484} = 22$

So a critical point given is $Q=22$

We can use the 2nd derivative to confirm if this is a minimum or maximum. In theory, but confirming if the 2nd derivative is positive, our graph would essentially concave up, ensuring positive values and therefore confirming $Q=22$ is a minimum quantity to meet demand. A negative equation from the 2nd derivative would indicate a concave down suggesting the opposite and hence it is a maximum.

$\frac{d^2C(Q)}{dQ^2}(-\frac{907.5}{Q^2} + \frac{3.75}{2})$ 
 
can be solved like the first equation by finding the derivative for each, however the derivative of a constant (the 2nd term) is just 0, wo we will just solve for the first term.

$\frac{d^2C(Q)}{dQ^2}(-\frac{907.5}{Q^2}) \rightarrow \frac{d^2C(Q)}{dQ^2}(-907.5 \times Q^{-2}) \rightarrow -2 \times -907.5  \times Q^{-3}$

which simplified is $\frac{1815}{Q^3}$ showing that for $Q>0$ the second derivative is always positive, confirming $Q=22$ is a minimum.

The minimize total inventory costs is just solving for $\frac{D}{Q} \rightarrow \frac{110}{22} = 5$

### Answer

$\therefore \ \ Optimal \ Order \ Quantity (Q) = 22 \ units$

$No. \ Annual \ Orders = 5 \ orders$

## Question 2

**Revenue Maximization**

**Scenario**

A company is running an online advertising campaign. The effectiveness of the campaign, in terms of revenue generated per day, is modeled by the function: $R(t)=-3150t^{-4}-220t+6530$
Where:

- $R(t)$ represents the revenue in dollars after $t$ days of the campaign.

**Task**

Determine the time $t$ at which the revenue is maximized by finding the critical points of the revenue function and determining which point provides the maximum value. What is the maximum revenue the company can expect from this campaign?

**Solution**

As in **Problem 3, Question 1** we need to find the critical point of the derivative, than use the second derivative to decide if it is the maximum or minimum.

$\therefore R'(t)=\frac{dR}{dt}(-3150t^{-4}-220t+6530)$

using the **power rule** becomes

- $\frac{d}{dt}(-3150t^{-4})=-4 \cdot -3150 t^{-4-1}=12600t^{-5}$ or $\frac{12600}{t^5}$

- $\frac{d}{dt}(-220t)=-220$

- $\frac{d}{dt}(6530)=0$

resulting in $R'(t)=\frac{12600}{t^5}-220$

If we solve for the critical point we get $\frac{12600}{t^5}-220 \rightarrow \frac{12600}{t^5}=220 \rightarrow t^5 = \frac{12600}{220} = 57.27273$

$t= \sqrt[5]{57.27273}=2.24693 \ days$

$R''(t)=\frac{d}{dt}(\frac{12600}{t^5}-220)=-5 \cdot \frac{12600}{t^6}$

$=-\frac{63000}{t^6}$

So for $t>0$ , $R''(t)<0$ *(since* $t^6>0$ *)* making $t=2.24693$ the maximum.

Lastly we can plug in for $R(2.24693)$

```{r}
(-3150*2.24693^(-4))-(220*2.24693)+6530
```

### Answer

The revenue maximizes at $\approx 2.25 \ days$

The maximum revenue that is expected is $\approx \$5912.09$

## Question 3 

**Demand Area Under Curve**

**Scenario**

A company sells a product at a price that decreases over time according to the linear demand function:
Where: $P(x)=2x-9.3$

$P(x)$ is the price in dollars, and $x$ is the quantity sold.

**Task**

  The company is interested in calculating the total revenue generated by this product between two quantity levels, $x_1 = 2$ and $x_2 = 5$, where the price still generates sales. Compute the area under the demand curve between these two points, representing the total revenue generated over this range.
  
- Demand function: $P(x)=2x-9.3$
- Based on the function quantity is defined by $x$
- Revenue as a product of price and quantity is:
$\therefore P(x) \cdot (x) \rightarrow x \cdot (2x-9.3) = 2x^2-9.3x$

So what we want is $\int_{x_1}^{x_2}R(x)dx=\int_{2}^{5}(2x^2-9.3x)dx$

Using the function drafted and the $integrate()$ function we can solve

```{r}
# Define the revenue function
R <- function(x) {
  2 * x^2 - 9.3 * x
}

# Calculate the definite integral from x = 2 to x = 5
result_p3_3 <- integrate(R, lower = 2, upper = 5)

# Print the result
cat("The total revenue is:", result_p3_3$value, "\n")
cat("Estimated error:", result_p3_3$abs.error, "\n")

```

### Answer 

The total revenue generated over this range is -\$19.65 indicating that the price at the upper level of 5 units, is too low to generate revenue.

## Question 4

**Profit Optimization**

**Scenario**

A beauty supply store sells flat irons, and the profit function associated with selling 
x flat irons is given by:

$\Pi(x) = xln(9x)-\frac{x^6}{6}$ 

Where:

- $\Pi(x)$ is the profit in dollars.

**Task**

Use calculus to find the value of $x$ that maximizes profit. Calculate the maximum profit that can be achieved and determine if this optimal sales level is feasible given market conditions.

**Solution**

In line with previous steps I will use the first derivative to find the critical points when set to 0 and use the second derivative to indicate if it is a minimum or maximum. Finally I will substitute for my answer.

$\Pi'(x) =\frac{d}{dx}( xln(9x)-\frac{x^6}{6})$ 

$\rightarrow \frac{d}{dx}[xln(9x)]=\frac{d}{dx}[x] \cdot ln(9x) + x \cdot \frac{d}{dx}[ln(9x)]$

**NOTE:** $[ln(u(x))]'=\frac{1}{ux}\cdot u'(x)$ when using the chain rule

$= 1ln(9x) + x \cdot \frac{1}{9x} \cdot \frac{d}{dx}[9x] =ln(9x) + \frac{9x \cdot \frac{d}{dx}[x]}{9x} = ln(9x)+\frac{d}{dx}x$

which just equals to $ln(9x)+1$ and $\frac{d}{dx}(-\frac{x^6}{6})=-6\cdot \frac{x^5}{6} = -x^5$

resulting in $\Pi ' (x) = ln(9x) +1 -x^5$ and when set to 0 $ln(9x)+1-x^5=0$

The problem can't really be solved algebraically, so I will find the second derivative and use R to solve for it.

$\Pi''(x)=\frac{d}{dx}[ln(9x)+1-x^5]$ and we know $\frac{d}{dx}1=0$ and $\frac{d}{dx}-x^5=-5x^4$

for $\frac{d}{dx}ln(9x)=\frac{1}{9x} \cdot \frac{d}{dx}[9x]=\frac{9 \cdot \frac{d}{dx}[x]}{9x}=\frac{1}{x}$

making $\Pi''(x)=\frac{1}{x}-5x^4$ which confirms it is a maximum.

Now solving for the first derivative's critical point and pluggin into the original equation we get

```{r}
# Define the derivative of the profit function
profit_derivative <- function(x) {
  log(9 * x) + 1 - x^5
}

# Use uniroot to find the critical point (root)
profit_x_result <- uniroot(profit_derivative, lower = 0.1, upper = 2) # Adjust bounds as needed
critical_x <- profit_x_result$root

# Print the critical value of x
cat("Critical x value:", critical_x, "\n")

# Define the profit function
profit_function <- function(x) {
  x * log(9 * x) - (x^6) / 6
}

# Calculate the maximum profit
max_profit <- profit_function(critical_x)
cat("Maximum profit:", max_profit, "\n")

```

### Answer

- The value of $x$ that maximizes profit is $1.280634$
- The maximum profit achievable is $\approx \$2.40$


## Question 5

**Spending Behavior**

**Scenario**

A market research firm is analyzing the spending behavior of customers in a retail store. The spending behavior is modeled by the probability density function: $f(x)=\frac{1}{6x}$

Where $x$ represents spending in dollars.

**Task**

Determine whether this function is a valid probability density function over the interval $[1,e^6]$. If it is, calculate the probability that a customer spends between \$1 and \$$e^6$.

**Solution**

To test for a valid probability density function (PDF) we just have to test for the following.

1. Non-negativity: $f(x)\geq 0$ for all $x$ in the interval $[1,e^6]$. Since $f(x)=\frac{1}{6x}$ has a constant, and $x \in [1,e^6]$ we see this condition is already met.
2. Normalization: Integral of $f(x)$ over $[1,e^6]$ has to equal 1.

$\int_1^{e^6}f(x)dx=\int_1^{e^6}\frac{1}{6x}dx=\frac{1}{6}\int_1^{e^6}\frac{1}{x}dx=\frac{1}{6}[ln(x)]_1^{e^6}=\frac{1}{6}(ln(e^6)-ln(1))$

**Note**

$ln(e^a)=a$ and $ln(1)=0$

$\therefore \ \frac{1}{6}(ln(e^6)-ln(1))=\frac{1}{6} \cdot 6 = 1$ satisfying the second condition.

### Answer

- $\int_1^{e^6}f(x)dx$ is a valid PDF
- The probability that a customer spends between \$1 and \$$e^6$ satisfies the entire range of our PDF meaning it $=1$ or the customer will always spend between these amounts.

## Question 6

**Market Share Estimation**

**Scenario**

An electronics company is analyzing its market share over a certain period. The rate of market penetration is given by: $\frac{dN}{dt}=\frac{500}{t^4+10}$

Where $N(t)$ is the cumulative market share at time $t$.

**Task**

Integrate this function to find the cumulative market share $N(t)$ after $t$ days, given that the initial market share $N(1)=6530$. What will the market share be after 10 days?

**Solution**

Noting that the initial value is $6530$ we should start by solving

$N(1)=\int_1^1 \frac{500}{t^4+10} + C = 6350$ where our C accounts for a constant that results in $6350$ since the integral of a function from point $a$ to $a$ is always 0 $\int_a^af(t)dt=0$

As a result we can conclude that $C=6350$ and can rewrite the function as $6350 + \int_1^t \frac{500}{t^4+10}dt$

and we can solve using below

```{r}
# Define the function to integrate
rate_of_change <- function(t) {
  500 / (t^4 + 10)
}

# Compute the definite integral from 1 to 10
integral_value <- integrate(rate_of_change, lower = 1, upper = 10)$value

# plug in the initial value
N_10 <- 6350 + integral_value

N_10

```

### Answer

The Marget share after 10 days will be $\$6399.54$


# Problem 4

**Business Optimization**

As a data scientist at a consultancy firm, you are tasked with optimizing various business functions to improve efficiency and profitability. Taylor Series expansions are a powerful tool to approximate complex functions, allowing for simpler calculations and more straightforward decision-making. This week, you will work on Taylor Series expansions of popular functions commonly encountered in business scenarios.

## Question 1

**Revenue and Cost**

**Scenario**

A company's revenue from a product can be approximated by the function $R(x)=e^x$, where $x$ is the number of units sold. The cost of production is given by $C(x)=ln(1+x)$. The company wants to maximize its profit, defined as $\Pi(x)=R(x)-C(x)$.

**Task**

### 1.

**Approximate the Revenue Function:** Use the Taylor Series expansion around $x=0$ (Maclaurin series) to approximate the revenue function $R(x)=e^x$ up to the second degree. Explain why this approximation might be useful in a business context.

**Solution**

The Taylor series for $f(x)$ about $c=0$ is:

$f(x)= \sum_{n=0}^{\infty}\frac{f^{(n)}(c)}{n!}(x-c)^n$

Here:

- $f^{(n)}(x)$ is the $n^{th}$ derivative of $f(x)$
- $f^{(n)}(c)$ is the value of the $n^{th}$ derivative evaluated at $x=c$

The Taylor Series Expansion of a function f(x) is given by:

$f(x) =f(c)+f'(c)(x-c)+\frac{f''(c)}{2!}(x-c)^2+\frac{f^{(3)}(c)}{3!}(x-c)^3+...$

The Maclaurin series is the expansion point $c=0$ making the formula $f(x)=f(0)+f'(0)x+\frac{f''(0)}{2!}x^2+....$ and we are only interested to the 2nd degree.

the derivative $\frac{d}{dx}(e^x)=e^x$ making these solutions all 1 b/c $f(0)=e^0=1,f'(0)=e^0=1,f''(0)=e^0=1$

### Answer

$\therefore R(x) \approx 1+x+\frac{x^2}{2}$

This is a useful business context in that approximations of how revenue changes can be done more rapidly with the simpler formula. This works very well with small values of $(x)$ or number of units sold, b/c the denominator grows much faster, making higher terms $\frac{x^3}{3!}$ almost negligible, meaning this approximations really won't lose much accuracy. 

### 2.

**Approximate the Cost Function:** Similarly, approximate the cost function $C(x)=ln(1+x)$ using its Maclaurin series expansion up to the second degree. Discuss the implications of this approximation for decision-making in production.

**Solution**

The Taylor Series Expansion of a function f(x) is given by:

$f(x) =f(c)+f'(c)(x-c)+\frac{f''(c)}{2!}(x-c)^2+\frac{f^{(3)}}{3!}(x-c)^3+...$

The Maclaurin series is the expansion point $a=0$ making the formula $f(x)=f(0)+f'(0)x+\frac{f''(0)}{2!}x^2+....$ and we are only interested to the 2nd degree.

Here we have $C(x)=ln(1+x), \ C'(x)=\frac{1}{1+x} ,C''(x)= -\frac{1}{(1+x)^2}$

**NOTE** $f'(a)$ where $f(c)=\frac{1}{1+c}=\frac{d}{dc}(1+c)^{-1}=-1 \cdot (1+ c)^{-1-1}=-(1+c)^{-2}=-\frac{1}{(1+c)^2}$

Solving for 0 we get $C(0)=0,C'(0)=1, C''(0)=-1$

Subsituting for $C(x)=C(0)+C'(0)x+\frac{C''(0)}{2!}x^2=0+x-\frac{x^2}{2}$

### Answer

$C(x) \approx x-\frac{x^2}{2}$

Considering the  equation is a logorithmic function, this simplified version would help to make decisions for a non-linear production cost, and is particularly accurate for small values of $x$.

### 3.

**Linear vs. Nonlinear Optimization:** Using the Taylor Series expansions, approximate the profit function $\Pi(x)$. Compare the optimization results when using the linear approximations versus the original nonlinear functions. What are the differences, and when might it be more appropriate to use the approximation?

$\Pi(x)_{original}=R(x)-C(x)=e^x-ln(1+x)$
$\Pi(x)_{linear \ approximation}=(1+x+\frac{x^2}{2})-(x-\frac{x^2}{2})=1+\frac{2x^2}{2}=1+x^2$

So we have 

$\Pi(x)_{linear \ approximation} =1+x^2$ and $\Pi'(x)_{linear \ approximation}=2x$ where $\Pi'(0)_{linear \ approximation}=0$ for our linear approximation

and considering $\Pi(x)=1+x^2$ is a parabola, we assume there is no maximum within a finite value, so profit will just increase as $x$ grows. 

for our original nonlinear function we have

$\Pi'(x)_{original}=\frac{d}{dx}(e^x-ln(1+x))=e^x-\frac{1}{1+x}$ and for $\Pi'(0)_{original}$ I will use R to calculate using $uniroot()$

```{r}
# Define the function f(x) = e^x - 1/(1 + x)
f_p4_1 <- function(x) {
  exp(x) - 1/(1 + x)
}

result_p4_1 <- uniroot(f_p4_1, c(0, 2)) 

cat("The optimal value of x is:", result_p4_1$root, "\n")

```

### Answer

For both functions I get 0 as the point of maximum profit. Despite retaining the same result, I feel the linear approximation over simplifies and stating that for all increases of x, it will yield a greater profit seems inaccurate, albiet the logorithmic original equation results in the same conclusion. With this linear approximation, I would likely only refer to it, so long as the values of $x$ remain small, as I believe it will quickly lose precision as it grows.

**Submission**

Provide your solutions using R-Markdown. Include the Taylor Series expansions, the approximated functions, and a discussion of the implications of using these approximations for business decision-making.

## Question 2

**Financial Modeling**

**Scenario**

A financial analyst is modeling the risk associated with a new investment. The risk is proportional to the square root of the invested amount, modeled as $f(x)=\sqrt{x}$, where $x$ is the amount invested. However, to simplify calculations, the analyst wants to use a Taylor Series expansion to approximate this function for small investments.

**Task**

### 1.

**Maclaurin Series Expansion:** Derive the Taylor Series expansion of $f(x)=\sqrt{x}$ around $x=0$  up to the second degree.

**Solution**

Like before we have to find $f'(x) \ and \ f''(x)$ then $f(0),f'(0) \ and \ f''(0)$

- $f(x)=x^{\frac{1}{2}} \rightarrow \ \sqrt{x}$
- $f'(x)=\frac{1}{2}x^{-1/2} \rightarrow \ \frac{1}{2\sqrt{x}}$
- $f''(x)=-\frac{1}{4}x^{-3/2} \rightarrow \ -\frac{1}{4x^{3/2}}$

For $f(0),f'(0) \ and \ f''(0)$ the answer is undefined. The best approach is to rework and avoid direct evaluation at $x=0$.

We can do this by directly applying the Taylor series around $x_0$ where $x_0$ is a value close to but not exactly zero.

$\therefore \ \ f(x) \approx f(x_0)+f'(x_0)(x-x_0)+\frac{f''(x_0)}{2!}(x=x_0)^2$ stopping at the second degree. 

- $f(x_0)=\sqrt{x_0}$
- $f'(x_0)=\frac{1}{2\sqrt{x_0}}$
- $f''(x_0)=-\frac{1}{4x_{0}^{3/2}}$

and after substituting in our Taylor series we get our :

### Answer

$f(x) \approx \sqrt{x_{0}}+\frac{1}{2\sqrt{x_0}}(x-x_0)-\frac{1}{8x_{0}^{3/2}}(x-x_0)^2$

### 2.

**Practical Application:** Use the derived series to approximate the risk for small investment amounts (e.g., when $x$ is small). Compare the approximated risk with the actual function values for small and moderate investments. Discuss when this approximation might be useful in financial modeling.

```{r}
# Function for the original function sqrt(x)
f_p4q3 <- function(x) {
  return(sqrt(x))
}

# Function for the Taylor series approximation
taylor_approx_p4q3 <- function(x, x0) {
  f_x0 <- sqrt(x0)
  f_prime_x0 <- 1 / (2 * sqrt(x0))
  f_double_prime_x0 <- -1 / (4 * x0^(3/2))
  
  # Taylor series expansion up to second degree
  return(f_x0 + f_prime_x0 * (x - x0) + (f_double_prime_x0 / 2) * (x - x0)^2)
}

# Define small and moderate investment amounts (x)
x_values_p4q3 <- c(0.1, 0.5, 1, 2, 5, 10)  # Investment amounts
x0 <- 1  # Point around which the Taylor series is expanded

# Calculate actual risk and Taylor approximation
actual_risk_p4q3 <- sapply(x_values_p4q3, f_p4q3)
taylor_risk_p4q3 <- sapply(x_values_p4q3, taylor_approx_p4q3, x0 = x0)

# Create a data frame for comparison
comparison <- data.frame(Investment = x_values_p4q3, Actual_Risk = actual_risk_p4q3, Taylor_Approx = taylor_risk_p4q3)

# Print the comparison
print(comparison)

# Plot for visual comparison
plot(x_values_p4q3, actual_risk_p4q3, type = "o", col = "lightblue", pch = 16, xlab = "Investment (x)", ylab = "Risk (f(x))", main = "Risk Approximation vs Actual")
lines(x_values_p4q3, taylor_risk_p4q3, type = "o", col = "darkgreen", pch = 16)
legend("topright", legend = c("Actual Risk", "Taylor Approximation"), col = c("lightblue", "darkgreen"), pch = 16)

```

### Answer

Just from the comparison, the values accuracy is better the closer it is to 0, but very quickly becomes inaccurate as it grows. My recommendation would be to use for values of very small sizes.

### 3. 

**Optimization Scenario:** Suppose the goal is to minimize risk while maintaining a certain level of investment return. Using the Taylor Series approximation, suggest an optimal investment amount $x$ that balances risk and return.

### Answer

- Small investments (around x=1) give an accurate approximation.
- moderate investments (around x=2), is reasonable with divergence.
- Large investments the Taylor expansion is just not very useful because of how little it reflects real risk. In such a investment, utilize the original function or derive a more complex one.

**Submission**

Present your results in R-Markdown, including the Taylor Series expansions, comparisons between the original and approximated functions, and your recommendations based on the analysis.

## Question 3 

**Inventory Management**


**Scenario**

In a manufacturing process, the demand for a product decreases as the price increases, modeled by $D(p)=1-p$, where $p$ is the price. The cost associated with producing and selling the product is modeled as $C(p)=e^p$. The company wants to maximize its profit, which is the difference between revenue and cost.

**Task**

### 1. 

**Taylor Series Expansion:** Expand the cost function $C(p)=e^p$ into a Taylor Series around $p=0$ up to the second degree. Discuss why approximating the cost function might be useful in a pricing strategy.

**Solution**

The Taylor series for $C(p)$ about $p$ is:

$C(p)= \sum_{n=0}^{\infty}\frac{C^{(n)}(0)}{n!}(p-c)^n$

Here:

- $C^{(n)}(p)$ is the $n^{th}$ derivative of $C(p)$
- $C^{(n)}(0)$ is the value of the $n^{th}$ derivative evaluated at $p=0$


The expansion point $p=0$ makes the formula  $C(p)=C(0)+C'(0)p+\frac{C''(0)}{2!}p^2+....$ and we are only interested to the 2nd degree.

the derivative $\frac{d}{dx}(e^x)=e^x$ making these solutions all 1 b/c $C(0)=e^0=1,C'(0)=e^0=1,C''(0)=e^0=1$

### Answer

$\therefore C(p) \approx 1+p+\frac{p^2}{2}$

This would be useful because:

- Simplification for Analysis: it easeir to calculate in this form
- Price adjustment: Ease with calculating marginal profits means its easier to adjust prices.
- Predicting is made simpler with the exclusion of the exponential, allowing for incremental predictions.

### 2.

**Approximating Profit:** Using the Taylor Series expansion, approximate the profit function $\Pi(p)=pD(p)-C(p)$. Compare the results when using the original nonlinear cost function versus the approximated cost function. What differences do you observe, and when might the approximation be sufficient?

First we need to substitute base on the scenario

- Demand Function: $D(p)=1-p$
- Cost Function: $C(p)=e^p$

$\therefore \ \ \Pi(p)=pD(p)-C(p) \rightarrow p(1-p)-e^p = p-p^2-e^p$

We can substitute the Taylor approximation ($C(p) \approx 1 +p + \frac{p^2}{p}$) to further transform the equation and get

$\Pi \approx p-p^2-1-p-\frac{p^2}{2} \rightarrow -1-\frac{3p^2}{2}$

```{r}
# range from 0 to 1
p_q4p2 <- seq(0, 1, by = 0.01)

# Exact profit function
Pi_exact_q4p2 <- p_q4p2 - p_q4p2^2 - exp(p_q4p2)

# Approximated profit function:
Pi_approx_q4p2 <- -1 - (3/2) * p_q4p2^2

# Plot both profit functions
plot(p_q4p2, Pi_exact_q4p2, type = "l", col = "lightgreen", lwd = 2, 
     xlab = "Price (p)", ylab = "Profit (Pi(p))", 
     main = "Exact and Approximated Profit Functions Comparison")
lines(p_q4p2, Pi_approx_q4p2, col = "purple", lwd = 2, lty = 2)

# Add a legend
legend("topright", legend = c("Exact Profit Function", "Approximated Profit Function"),
       col = c("lightgreen", "purple"), lwd = 2, lty = c(1, 2))

# Add grid
grid()

```

### Answer

The original profit has a the linear term p which the approximation cancelled out, suggesting that the approximation neglects linear affect, which for small values is negligible but for larger may be an issue. Also the quadratic term found in both is divided ($-\frac{3p^2}{2}$) in the approximation, which may overestimate the negative quatdratic impact as the values grow.

### 3.

**Pricing Strategy:** Based on the Taylor Series approximation, suggest a pricing strategy that could maximize profit. Explain how the Taylor Series approximation helps in making this decision.


### Answer

The approximation is great for setting an initial low price, as the optimal pricing in this formula is p=0, and is not applicable the further away from 0. A more sophisticated model should be used after gathering more data on customer behavior.

**Submission**

Include your analysis in R-Markdown, with Taylor Series expansions, comparisons of the approximated and original functions, and a discussion of the implications for pricing strategy.



## Question 4

**Economic Forecasting**

**Scenario**

An economist is forecasting economic growth, which can be modeled by the logarithmic function $G(x)=ln(1+x)$, where $x$ represents investment in infrastructure. The government wants to predict growth under different levels of investment.

**Task**

### i.

**Maclaurin Series Expansion:** Derive the Maclaurin Series expansion of $G(x)=ln(x+1)$ up to the second degree. Explain the significance of using this approximation for small values of $x_x$ in economic forecasting.

- $G(x) =ln(x+1) \ and \ G(0)=ln(1)=0$
- $G'(x) = \frac{1}{x+1} \ and \ G'(0)=1$
- $G''(x)=\frac{1}{(x+1)^2} \ and \ G''(0)=-\frac{1}{1^2}=-1$
- $G(x) \approx 0+1 \cdot + \frac{-1}{2} \cdot x^2 = x- \frac{x^2}{2}$

### Answer

$x- \frac{x^2}{2}$ This is a simplified and linear-ish equation that accounts for diminishing returns with $-\frac{x^2}{2}$. Its realistic, considering early investment might have greater early returns that diminish over time. Therefore, this is a very practical approximation.

### ii.

**Approximation of Growth:** Use the Taylor Series to approximate the growth for small investments. Compare this approximation with the actual growth function. Discuss the accuracy of the approximation for different ranges of $x_x$.

```{r}
# range from 0 to 1
x_q4p4 <- seq(0, 1, by = 0.01)

# Exact economic growth function
x_exact_q4p4 <- log(x_q4p4+1)

# Approximated growth function:
x_approx_q4p4 <- x_q4p4 - x_q4p4^2/2

# Plot both profit functions
plot(x_q4p4, x_exact_q4p4, type = "l", col = "orange", lwd = 2, 
     xlab = "Price (p)", ylab = "Profit (Pi(p))", 
     main = "Exact and Approximated Growth Functions Comparison")
lines(x_q4p4, x_approx_q4p4, col = "darkblue", lwd = 2, lty = 2)

# Add a legend
legend("topright", legend = c("Exact economic growth function", "Approximated growth Function"),
       col = c("orange", "darkblue"), lwd = 2, lty = c(1, 2))

# Add grid
grid()
```

### Answer

- For values $x\leq0.2$ the approximation is very accurate.
- For values $0.2 \geq x \leq 0.5$ the approximations are moderately accurate.
- above 0.5 however its accuracy is very low and unreliable.

### iii.

**Policy Recommendation:** Using the approximation, recommend a level of investment that could achieve a target growth rate. Discuss the limitations of using Taylor Series approximations for such policy recommendations.

### Answer

Use the approximation to estimate the investment needed to achieve a taget growth rate. However this approximation works best for small investments, so using values below 0.2 would be ideal as the model becomes inaccurate as it grows to and past 0.5

**Submission**

Provide your answers in R-Markdown, with the Taylor Series expansions, comparisons between the approximated and original functions, and your investment recommendations.

# Problem 5 

**Profit, Cost, & Pricing**

## Question 1 

**Profit Maximization**

**Scenario**

A company produces two products, A and B. The profit function for the two products is given by $\Pi(x,y)=30x-2x^2-3xy+24y-4y^2$

Where:

- $x$ is the quantity of Product A produced and sold.
- $y$ is the quantity of Product B produced and sold.
- $\Pi(x,y)$ is the profit in dollars.

**Task**

Find all local maxima, local minima, and saddle points for the profit function $\Pi(x,y)$.
Write your answer(s) in the form $(x,y,\Pi(x,y))$. Separate multiple points with a comma.

**Solution**

since we are using partial derivatives we need to do the derivatives for $x, y, x$ then $y$ and $y$ then $x$

- $\Pi(x,y)=30x-2x^2-3xy+24y-4y^2$
- $\partial_x f(x,y)=\frac{\partial \Pi}{\partial x}(30x-2x^2-3xy+24y-4y^2)$ equals to $30-4x-3y$
- $\partial_{xx} f(x,y)=\frac{\partial^2 \Pi}{\partial x^2}(30-4x-3y)$ equals to $-4$
- $\partial_{xy} f(x,y)=\frac{\partial^2 \Pi}{\partial x \partial y}(30-4x-3y)$ equals to $-3$
- $\partial_y f(x,y)=\frac{\partial \Pi}{\partial y}(30x-2x^2-3xy+24y-4y^2)$ equals to $24-3x-8y$
- $\partial_{yy} f(x,y)=\frac{\partial^2 \Pi}{\partial y^2}(24-3x-8y)$ equals to $-8$
- $\partial_{yx} f(x,y)=\frac{\partial^2 \Pi}{\partial y \partial x}(24-3x-8y)$ equals to $-3$
- The discriminant $D$ is given by the determinant of Hessian Matrix H below or just calculate for $D=\frac{\partial^2 \Pi}{\partial x^2} \cdot \frac{\partial^2 \Pi}{\partial y^2} - (\frac{\partial^2 \Pi}{\partial x \partial y})^2$ to the local minimum/maximum.

$$
H = \begin{pmatrix}
-4 & -3 \\
-3 & -8 \\
\end{pmatrix} \ \
$$

- Substitute $D=\frac{\partial^2 \Pi}{\partial x^2} \cdot \frac{\partial^2 \Pi}{\partial y^2} - (\frac{\partial^2 \Pi}{\partial x \partial y})^2$ to get $D=(-4)(-8)-(-3)^2=32-9=23$
- Since $\partial_{xx} f(x,y)$ is negative and determinant is positive we assume the critical point corresponds with a maximum.

we need to find the critical points by setting $\partial_x f(x,y)$ and $\partial_y f(x,y)$ to 0

$\partial_x f(x,y) \rightarrow 30-4x-3y=0 \rightarrow y= \frac{30-4x}{3}$

$\partial_y f(x,y) \rightarrow 24-3x-8y=0 \rightarrow$ substituting for y with above equation we get $24-3x-8(\frac{30-4x}{3})=0 \rightarrow 24-3x-\frac{240-32x}{3}=0$ 

We multiply through by $3$ to get $72-9x-240+32x=0 \rightarrow 23x=168$ making one of our critical points $x=\frac{168}{23}$

To find the second critical point we need to substitute in the $\partial_x f(x,y)$ equation:

$\frac{\partial \Pi}{\partial x}\rightarrow30-4x-3y=0 \rightarrow 30-4(\frac{168}{23})-3y=0 \rightarrow 30-\frac{670}{23}=3y\rightarrow 3y=\frac{18}{23}\rightarrow y=\frac{18}{23} \cdot \frac{1}{3}$ to get $y=\frac{6}{23}$

We now substitute the values in the original function

$\Pi(x,y)=\Pi(\frac{168}{2},\frac{6}{23})=30(\frac{168}{2})-2(\frac{168}{2})^2-3(\frac{168}{2})(\frac{6}{23})+24(\frac{6}{23})-4(\frac{6}{23})^2$

$\rightarrow \frac{5040}{23}-\frac{56448}{529}-\frac{3024}{529}+\frac{144}{23}-\frac{144}{529}\rightarrow \frac{5184}{23}-\frac{59616}{529}=\frac{59616}{529}=\frac{2592}{23}$ to get $\Pi(\frac{168}{23},\frac{6}{23})=\frac{2592}{23}$


**Discussion**

Discuss the implications of the results for the company’s production strategy. Which production levels maximize profit, and what risks are associated with the saddle points?

### Answer

$\Pi(\frac{168}{23},\frac{6}{23})=\frac{2592}{23}$

With our local maximum at $23$ indicating no saddle points.
The Optimal Production Levels are:

- **Product A:** $x=\frac{168}{23} \approx 7.30$
- **Product B:** $y=\frac{6}{23} \approx 0.26$ 

With a maximum profit of $\approx \$112.69$

Considering the no saddle points were identified, there's no need to worry about regions with production decisions that have unpredictable results. Are market strategy should leverage the Optimal production levels to produce the correct number of units, but obviously monitor to avoid overproduction or change in performance.

## Question 2 

**Pricing Strategy**

**Scenario**

A supermarket sells two competing brands of a product: Brand X and Brand Y. The store manager estimates that the demand for these brands depends on their prices, given by the functions:

- Demand for Brand X: $D_x(x,y)=120-15x+10y$
- Demand for Brand Y: $D_y(x,y)=80+5x-20y$

Where:

- $x$ is the price of Brand X in dollars.
- $y$ is the price of Brand Y in dollars.
- $D_x(x,y)$ and $D_x(x,y)$ are the quantities demanded for Brand X and Brand Y, respectively.

**Task**

1. **Revenue Function:** Find the revenue function R(x,y) for both brands combined.
2. **Optimal Pricing:** Determine the prices $x$ and $y$ that maximize the store’s total revenue. Are there any saddle points to consider in the pricing strategy?

**Solution**

**Revenue X** equals **(Brand X in dollars)** times **(Demand for Brand X)**

Therefore $R_x(x,y)=x \cdot D_x(x,y)$ 

Which we substitute with $R_x(x,y)= x \cdot 120-15x+10y$ which equals $120x-15x^2+10xy$

**Revenue Y** equals **(Brand Y in dollars)** times **(Demand for Brand Y)**

Therefore $R_y(x,y)=y \cdot D_y(x,y)$ 

Which we substitute with $R_y(x,y)= y \cdot 80+5x-20y$ which equals $80y+5xy-20y^2$

**Total Revenue** equals **Revenue X** times **Revenue Y**

Therefore $R(x,y)=R_x(x,y)+R_y(x,y)$

Which we substitute with $R(x,y)=(120x-15x^2+10xy)+(80y+5xy-20y^2)$ which equals $-15x^2-20y^2+120x+80y+15xy$


**Partial Derivatives** are needed to find the critical points and saddle if there exists one.

$\frac{\partial R(x,y)}{\partial x}= -30x+120+15y$

$\frac{\partial R(x,y)}{\partial y}= -40y +80+15x$

$\frac{\partial^2 R(x,y)}{\partial x^2}= -30$

$\frac{\partial^2 R(x,y)}{\partial y^2}= -40$

$\frac{\partial^2 R(x,y)}{\partial x \partial y}= 15$

$\frac{\partial^2 R(x,y)}{\partial y \partial x}= 15$

The discriminant $D$ is given by the determinant of Hessian Matrix H below or just calculate for $D=\frac{\partial^2 \Pi}{\partial x^2} \cdot \frac{\partial^2 \Pi}{\partial y^2} - (\frac{\partial^2 \Pi}{\partial x \partial y})^2$ to the local minimum/maximum.

$$
H = \begin{pmatrix}
-30 & 15 \\
15 & -40 \\
\end{pmatrix} \ \
$$

$det(H)=(-30)(-40)-(15)(15)=1200-225=975$ which because $det(H) \neq 0$ we can assume no local saddle

since $\frac{\partial^2 R(x,y)}{\partial x^2}$ is negative and $det(h)$ is positive we assume the critical points corresponds to a maximum

we can find the critical points by setting $\frac{\partial R(x,y)}{\partial x}$ and $\frac{\partial R(x,y)}{\partial y}$ to $0$ and solving for $x$ and $y$

- $-30x+120+15y=0 \rightarrow 30x=120+15y$ which equals $x=4+\frac{y}{2}$
- $-40y +80+15x=0 \rightarrow 40y=80+15x$ which equals $y=2+\frac{3x}{8}$
- Then we substitute the new equation for $y$ into our other equation for $x$ to get $x=4+\frac{1}{2}(2+\frac{3x}{8})$
- This simplifies to $x=5+\frac{3x}{16}$
- Multiply through with $16$ to get $16x=80+3x$ which becomes $x=\frac{80}{13}=6.153846$
- Substitute $x$ into $y=2+\frac{3x}{8}$ to get $4.307692$


**Discussion**

Explain the significance of the optimal pricing strategy and how it can be applied in a competitive retail environment.

### Answer

Revenue function R(x,y) for both brands combined is:

$R(x,y)=-15x^2-20y^2+120x+80y+15xy$

Optimal prices are 

$x \approx 6.15, \ y \approx 4.31$

**Note** No local saddle

The equation is meant to find optimal pricing by accounting for the competitors prices. This strategy will ensure retailer is operating at peak. The goal is for this equation to provide highest possible revenue based on price and demand, using functions $D_x(x,y) \ and \ D_x(x,y)$ which are derived from consumer behavior. The retailer would likely benefit from avoiding pitfalls such as under pricing and overpricing, and allow for the implementation of discounts, sales, coupons, etc. based on market conditions, because the pricing can be adjusted dynamically.

## Question 3 

**Cost Minimization**

**Scenario**

A manufacturing company operates two plants, one in New York and one in Chicago. The company needs to produce a total of 200 units of a product each week. The total weekly cost of production is given by $C(x,y)=\frac{1}{8}x^2+\frac{1}{10}y^2+12x+18y+1500$

Where:

- $x$ is the number of units produced in New York.
- $y$ is the number of units produced in Chicago.
- $C(x,y)$ is the total cost in dollars.

**Task**

1. Determine how many units should be produced in each plant to minimize the total weekly cost.
2. What is the minimized total cost, and how does the distribution of production between the two plants affect overall efficiency?

**Solution**

Goal is to minimize $C(x,y)=\frac{1}{8}x^2+\frac{1}{10}y^2+12x+18y+1500$ under the constraint $x+y=200$

Rewrite $x+y=200 \rightarrow y=200-x$

Substitute in the cost function to get $C(x,y)=\frac{1}{8}x^2+\frac{1}{10}(200-x)^2+12x+18(200-x)+1500$

Expand to $C(x,y)=\frac{1}{8}x^2+\frac{1}{10}(40000-400x+x^2)+12x+3600-18x+1500$

Simplify to $C(x,y)=\frac{1}{8}x^2+4000-40x+\frac{1}{10}x^2+12x+3600-18x+1500$

Add like terms to get $C(x)=\frac{9}{40}x^2-46x+9100$

What end up with is a quadratic equation that we would like the minimum to. Therefore we can calculate the vertex of a parabola get the minimum for $x$ then substitue $y$ in our constraint.

vertex equals $x=-\frac{b}{2a}$ where $a=\frac{9}{40}$ and $b=-46$

substitute to get $x=\frac{-46}{2 \cdot \frac{9}{40}}=\frac{46 \cdot 40}{18}=\frac{1840}{18}\approx 102.22$

substitute from the constraint $y=200-102.22 \approx 97.78$

And then substitute in the original cost function

$C(102.22,97.78)=\frac{1}{8}(102.22)^2+\frac{1}{10}(97.78)^2+12(102.22)+18(97.78)+1500$

```{r}
(1/8)*(102.22)^2+(1/10)*(97.78)^2+12*(102.22)+18*(97.78)+1500
```

**Discussion**

Discuss the benefits of this cost-minimization strategy and any practical considerations that might influence the allocation of production between the two plants.

This formula is really about cost efficiency, by allocation production optimally, a strategy that balances production can be made. This would in turn affect profit margins and avoids excessive costs that can occur from overloading one of the two plants.

### Answer

Production Distribution for NY  is $x \approx 102.22$ and for Chicagor is $y \approx 97.78$
with a minimized cost of $C(x,y) \approx \$6,748.89$

## Question 4

**Marketing Mix**

**Scenario**

A company is launching a marketing campaign that involves spending on online ads ($x$) and television ads ($y$). The effectiveness of the campaign, measured in customer reach, is modeled by the function $E(x,y)=500x+700y-5x^2-10xy-8y^2$

Where:

- $x$ is the amount spent on online ads (in thousands of dollars).
- $y$ is the amount spent on television ads (in thousands of dollars).
- $E(x,y)$ is the estimated customer reach.

**Task**

1. Find the spending levels for online and television ads that maximize customer reach.
2. Identify any saddle points and discuss how they could affect the marketing strategy.

**Solution**

We want to maximize $E(x,y)=500x+700y-5x^2-10xy-8y^2$

We will require the partial derivatives

- $\frac{\partial E}{\partial x}=500-10x-10y$
- $\frac{\partial E}{\partial y}=700-10x-16y$
- $\frac{\partial^2 E}{\partial x^2}=-10$
- $\frac{\partial^2 E}{\partial y^2}=-16$
- $\frac{\partial^2 E}{\partial x \partial y}=-10$
- $\frac{\partial^2 E}{\partial y \partial x}=-10$
- The discriminant $D$ is given by the determinant of Hessian Matrix H below or just calculate for $D=\frac{\partial^2 \Pi}{\partial x^2} \cdot \frac{\partial^2 \Pi}{\partial y^2} - (\frac{\partial^2 \Pi}{\partial x \partial y})^2$ to the local minimum/maximum.

$$
H = \begin{pmatrix}
-10 & -10 \\
-10 & -16 \\
\end{pmatrix} \ \
$$

- H=(-10)(-16)-(-10)^2=160-100=60

Critical point classifications:

- $H>0$ and $E_{xx}<0$, local maximum
- $H>0$ and $E_{xx}>0$, local minimum
- $H<0$, saddle point
- $H=60>0$ and $E_{xx}=-10.0$ therefore our critical point is a local maximum.

To get critical points we set $\frac{\partial E}{\partial x}$ and $\frac{\partial E}{\partial y}$ to zero

- $500-10x-10y=0 \rightarrow 10x+10y=500$ which gives us $x+y=50$
- $700-10x-16y=0 \rightarrow 10x+16y=700$ which gives us $x+1.6y=70$
- We can eliminate $x$ and solve for $y$ by subtracting these terms $(x+1.6y=50)-(x+y=50)$
- Which gives us $0.6y=20$ and results in $\approx 33.33$
- We can then substitute $y$ in $x+y=50$ to get $x+33.33=50 \rightarrow x=50-33.33$ which gives us $\approx 16.67$



**Discussion**

Explain how the results can be used to allocate the marketing budget effectively and what the company should consider if it encounters saddle points in the optimization.

### Answer

Optimized spending

Online Ads = $16.67 \times 1000(\$) = \$16,670$

Television Ads = $33.33 \times 1000(\$)=\$33,330$

Maximum customers reached is $E(16.67,33.33)=500(16.67)+700(33.33)-5(16.67)^2-10(16.67)(33.33)-8(33.33)^2$

```{r}
500*(16.67)+700*(33.33)-5*(16.67)^2-10*(16.67)*(33.33)-8*(33.33)^2
```


**As always, include a professional pdf only with all code, text, graphics, explanations, etc.**